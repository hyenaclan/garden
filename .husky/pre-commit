#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Run tests
echo "ğŸ“ Running tests..."
npm test || exit 1

# Run linting
echo "ğŸ¨ Running linter..."
npm run lint || exit 1

# Run type checking
echo "ğŸ”§ Type checking..."
npm run check-types || exit 1

# Generate OpenAPI spec (optional - only if script exists)
if grep -q "generate-openapi" package.json; then
  echo "ğŸ“„ Generating OpenAPI spec..."
  npm run generate-openapi && git add apps/api/openapi.json 2>/dev/null || echo "âš ï¸  OpenAPI generation skipped"
fi

echo "âœ… All pre-commit checks passed!"
